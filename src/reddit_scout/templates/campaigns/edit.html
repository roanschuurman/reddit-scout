{% extends "base.html" %}

{% block title %}Edit {{ campaign.name }} - Reddit Scout{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="flex items-center gap-4 mb-6">
        <a href="/campaigns/{{ campaign.id }}" class="btn btn-ghost btn-sm">Back</a>
        <h1 class="text-2xl font-bold">Edit Campaign</h1>
    </div>

    <form method="post" action="/campaigns/{{ campaign.id }}" class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <div class="form-control mb-4">
                <label class="label" for="name">
                    <span class="label-text">Campaign Name</span>
                </label>
                <input
                    type="text"
                    id="name"
                    name="name"
                    placeholder="e.g., My Product Launch"
                    class="input input-bordered w-full {% if errors and errors.name %}input-error{% endif %}"
                    value="{{ name if name is defined else campaign.name }}"
                    required
                />
                {% if errors and errors.name %}
                <label class="label">
                    <span class="label-text-alt text-error">{{ errors.name }}</span>
                </label>
                {% endif %}
            </div>

            <div class="form-control mb-4">
                <label class="label" for="system_prompt">
                    <span class="label-text">System Prompt</span>
                    <span class="label-text-alt">Instructions for AI response generation</span>
                </label>
                <textarea
                    id="system_prompt"
                    name="system_prompt"
                    placeholder="You are a helpful assistant..."
                    class="textarea textarea-bordered h-32 {% if errors and errors.system_prompt %}textarea-error{% endif %}"
                    required
                >{{ system_prompt if system_prompt is defined else campaign.system_prompt }}</textarea>
                {% if errors and errors.system_prompt %}
                <label class="label">
                    <span class="label-text-alt text-error">{{ errors.system_prompt }}</span>
                </label>
                {% endif %}
            </div>

            <div class="form-control mb-4">
                <label class="label" for="scan_frequency_minutes">
                    <span class="label-text">Scan Frequency</span>
                </label>
                <select
                    id="scan_frequency_minutes"
                    name="scan_frequency_minutes"
                    class="select select-bordered w-full {% if errors and errors.scan_frequency_minutes %}select-error{% endif %}"
                >
                    {% for minutes, label in scan_frequency_options %}
                    <option value="{{ minutes }}" {% if campaign.scan_frequency_minutes == minutes %}selected{% endif %}>
                        {{ label }}
                    </option>
                    {% endfor %}
                </select>
                {% if errors and errors.scan_frequency_minutes %}
                <label class="label">
                    <span class="label-text-alt text-error">{{ errors.scan_frequency_minutes }}</span>
                </label>
                {% endif %}
            </div>

            <div class="form-control mb-4">
                <label class="label" for="discord_channel_id">
                    <span class="label-text">Discord Channel ID</span>
                    <span class="label-text-alt">Optional - for notifications</span>
                </label>
                <input
                    type="text"
                    id="discord_channel_id"
                    name="discord_channel_id"
                    placeholder="e.g., 1234567890123456789"
                    class="input input-bordered w-full"
                    value="{{ campaign.discord_channel_id or '' }}"
                />
            </div>

            <div class="form-control mb-6">
                <label class="label cursor-pointer justify-start gap-3">
                    <input
                        type="checkbox"
                        name="is_active"
                        value="true"
                        class="checkbox checkbox-primary"
                        {% if campaign.is_active %}checked{% endif %}
                    />
                    <span class="label-text">Active</span>
                    <span class="label-text-alt text-base-content/50">Campaign will monitor for matches when active</span>
                </label>
            </div>

            <div class="card-actions justify-end">
                <a href="/campaigns/{{ campaign.id }}" class="btn btn-ghost">Cancel</a>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </form>
</div>
{% endblock %}
