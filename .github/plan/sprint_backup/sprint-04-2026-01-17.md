# Sprint 04 Summary: Reddit Scanner Service

**Date:** 2026-01-17
**Status:** DONE

## Goal

Build the core Reddit monitoring engine that scans configured subreddits for keyword matches and stores results for processing.

## Completed

### Features
- PRAW-based Reddit client with rate limiting and retry logic
- Keyword matching for posts and comments (case-insensitive, phrase support)
- Context snippet extraction around matched keywords
- Scanner service with campaign scheduling based on scan frequency
- Match deduplication using (campaign_id, reddit_id) unique index
- CLI command: `reddit-scout-scanner` with `--dry-run` and `--verbose` flags

### Technical
- Added `last_scanned_at` field to Campaign model
- Created migration `4a1b2c3d4e5f_add_scanner_fields.py`
- Simplified deployment scripts for Coolify (removed local DB dependency)
- All type annotations for mypy strict mode

### Testing
- 63 tests passing (26 new scanner tests)
- Ruff linting: passed
- Mypy: passed

## Files Changed

**New files:**
- `src/reddit_scout/scanner/client.py` - Reddit API wrapper
- `src/reddit_scout/scanner/matcher.py` - Keyword matching logic
- `src/reddit_scout/scanner/service.py` - Scanner service
- `src/reddit_scout/scanner/cli.py` - CLI runner
- `alembic/versions/4a1b2c3d4e5f_add_scanner_fields.py` - Migration
- `tests/test_scanner.py` - 26 new tests
- `scripts/dev.sh` - Local dev script

**Modified files:**
- `src/reddit_scout/scanner/__init__.py` - Exports
- `src/reddit_scout/models/campaign.py` - Added `last_scanned_at` field
- `pyproject.toml` - Added CLI script entrypoint
- `docker-compose.yml` - Simplified for remote dev DB
- `Dockerfile` - Removed postgresql-client
- `scripts/entrypoint.sh` - Simplified to just migrations + start
- `.env.example` - Updated with Coolify DB example

## Commit

`3c617fc` - feat(scanner): add Reddit scanner service
